<!DOCTYPE html>
<html lang=en>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5" />
    <meta name="description" content="Hello everyone, welcome to my blog again. It has been a busy week for me, and I did some work to preprocess the images for recognition.  See my work!In order to give you a clearer idea of what I did,">
<meta property="og:type" content="article">
<meta property="og:title" content="Week 2 - Image Preprocessing">
<meta property="og:url" content="https://www.jessexu.me/basis-senior-project/week2/index.html">
<meta property="og:site_name" content="Jesse&#39;s blog">
<meta property="og:description" content="Hello everyone, welcome to my blog again. It has been a busy week for me, and I did some work to preprocess the images for recognition.  See my work!In order to give you a clearer idea of what I did,">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://www.jessexu.me/img/bigz-senior-project-week2.assets/image-20210422173039847.png">
<meta property="og:image" content="https://www.jessexu.me/img/bigz-senior-project-week2.assets/image-20210423093322870.png">
<meta property="og:image" content="https://www.jessexu.me/img/bigz-senior-project-week2.assets/image-20210423114958615.png">
<meta property="og:image" content="https://www.jessexu.me/img/bigz-senior-project-week2.assets/image-20210423115652416.png">
<meta property="og:image" content="https://www.jessexu.me/img/bigz-senior-project-week2.assets/image-20210423120048713.png">
<meta property="og:image" content="https://www.jessexu.me/img/bigz-senior-project-week2.assets/image-20210423141418895.png">
<meta property="og:image" content="https://www.jessexu.me/img/bigz-senior-project-week2.assets/image-20210423142525498.png">
<meta property="article:published_time" content="2021-04-22T09:11:31.000Z">
<meta property="article:modified_time" content="2021-04-23T06:49:56.000Z">
<meta property="article:author" content="Jesse Xu">
<meta property="article:tag" content="Basis">
<meta property="article:tag" content="Senior Project">
<meta property="article:tag" content="English">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://www.jessexu.me/img/bigz-senior-project-week2.assets/image-20210422173039847.png">
    
    
      
        
          <link rel="shortcut icon" href="/favicon.ico">
        
      
      
        
          <link rel="icon" type="image/png" href="/favicon_192x192.png" sizes="192x192">
        
      
      
        
          <link rel="apple-touch-icon" sizes="180x180" href="/favicon_apple.png">
        
      
    
    <!-- title -->
    <title>Week 2 - Image Preprocessing</title>
    <!-- styles -->
    
<link rel="stylesheet" href="/css/style.css">

    <!-- persian styles -->
    
    <!-- rss -->
    
    
      <link rel="alternate" href="/true" title="Jesse&#39;s blog" type="application/atom+xml" />
    
	<!-- mathjax -->
	
		<script type="text/x-mathjax-config">
		  MathJax.Hub.Config({
			tex2jax: {
			  skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
			  inlineMath: [['$','$']]
			}
		  });
		</script>
		<script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-MML-AM_CHTML' async></script>
	
<meta name="generator" content="Hexo 5.4.2"></head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#" aria-label="Menu"><i class="fas fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#" aria-label="Menu"><i class="fas fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" "Top" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fas fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/2018/12/02/%E5%85%B3%E4%BA%8E%E6%AD%A4%E5%8D%9A%E5%AE%A2/">About</a></li>
         
          <li><a href="/archives/">Writing</a></li>
         
          <li><a href="/basis-senior-project-home/">Senior Project</a></li>
         
          <li><a href="/search/">Search</a></li>
        
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" aria-label="Previous post " href="/basis-senior-project/week3/"><i class="fas fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" aria-label="Next post " href="/basis-senior-project/week1/"><i class="fas fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" aria-label="Back to top " href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" aria-label="Share post " href="#"><i class="fas fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=https://www.jessexu.me/basis-senior-project/week2/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=https://www.jessexu.me/basis-senior-project/week2/&text=Week 2 - Image Preprocessing"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=https://www.jessexu.me/basis-senior-project/week2/&title=Week 2 - Image Preprocessing"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=https://www.jessexu.me/basis-senior-project/week2/&is_video=false&description=Week 2 - Image Preprocessing"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=Week 2 - Image Preprocessing&body=Check out this article: https://www.jessexu.me/basis-senior-project/week2/"><i class="fas fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=https://www.jessexu.me/basis-senior-project/week2/&title=Week 2 - Image Preprocessing"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=https://www.jessexu.me/basis-senior-project/week2/&title=Week 2 - Image Preprocessing"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=https://www.jessexu.me/basis-senior-project/week2/&title=Week 2 - Image Preprocessing"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=https://www.jessexu.me/basis-senior-project/week2/&title=Week 2 - Image Preprocessing"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=https://www.jessexu.me/basis-senior-project/week2/&name=Week 2 - Image Preprocessing&description="><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=https://www.jessexu.me/basis-senior-project/week2/&t=Week 2 - Image Preprocessing"><i class="fab fa-hacker-news " aria-hidden="true"></i></a></li>
</ul>

    </div>
    <div id="toc">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#See-my-work"><span class="toc-number">1.</span> <span class="toc-text">See my work!</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#What-does-the-program-do"><span class="toc-number">2.</span> <span class="toc-text">What does the program do?</span></a></li></ol>
    </div>
  </span>
</div>

    
    <div class="content index py4">
        
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle" itemprop="name headline">
        Week 2 - Image Preprocessing
    </h1>



    <div class="meta">
      <span class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span itemprop="name">Jesse Xu</span>
      </span>
      
    <div class="postdate">
      
        <time datetime="2021-04-22T09:11:31.000Z" itemprop="datePublished">2021-04-22</time>
        
        (Updated: <time datetime="2021-04-23T06:49:56.000Z" itemprop="dateModified">2021-04-23</time>)
        
      
    </div>


      

      
    <div class="article-tag">
        <i class="fas fa-tag"></i>
        <a class="tag-link-link" href="/tags/Basis/" rel="tag">Basis</a>, <a class="tag-link-link" href="/tags/English/" rel="tag">English</a>, <a class="tag-link-link" href="/tags/Senior-Project/" rel="tag">Senior Project</a>
    </div>


    </div>
  </header>
  

  <div class="content" itemprop="articleBody">
    <p>Hello everyone, welcome to my blog again. It has been a busy week for me, and I did some work to preprocess the images for recognition. </p>
<h2 id="See-my-work"><a href="#See-my-work" class="headerlink" title="See my work!"></a>See my work!</h2><p>In order to give you a clearer idea of what I did, I put some extra efforts to put my work as an web app using the free hosting service Heroku (huge thanks to them!), so that you can get your hands on and experiment with the program I wrote. You may find it here: <a target="_blank" rel="noopener" href="https://senior-project.jessexu.me/?file_selection=Week+2">https://senior-project.jessexu.me/?file_selection=Week+2</a> (loading time may be a bit long because the images are being processed in real-time, and make sure you have good Internet)</p>
<h2 id="What-does-the-program-do"><a href="#What-does-the-program-do" class="headerlink" title="What does the program do?"></a>What does the program do?</h2><p>You may be a bit confused if you head straight into the web app above, so let me explain what is the program I wrote this week doing. </p>
<p>I will use the parameters that I set as the default of the app when I’m explaining. They turn out to produce pretty good results after I experimented with them. </p>
<p> <img src="/img/bigz-senior-project-week2.assets/image-20210422173039847.png" alt="Default Parameters"></p>
<center>Default parameters<center/>

<p>Let’s start with the original image. It’s a photo of a part of the gyroscope. As mentioned in last week’s blog post, the preprocessing I need to apply on the photo is to denoise the image, find the contours of the part (in this photo’s case, the contours of the broaches&#x2F;combs), and find the corners of the parts. </p>
<img src="/img/bigz-senior-project-week2.assets/image-20210423093322870.png" alt="Original image" style="zoom:50%;" />

<p>First, we need to turn it into a grayscale image for further processing. OpenCV has a handy method for this: </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gray = cv2.cvtColor(img, cv2.COLOR_BGR2GRAY)</span><br></pre></td></tr></table></figure>

<img src="/img/bigz-senior-project-week2.assets/image-20210423114958615.png" alt="Grayscale image" style="zoom:50%;" />

<p>Then, we can filter out some of the noise in the photo to get a clearer shot by first dilating then eroding the image. It can be done with the following two lines of code. With higher iterations, more noise will be filtered out, but it may also distort the image. </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">kernel = np.ones((<span class="number">3</span>, <span class="number">3</span>), np.uint8) <span class="comment"># We use a commonly used 3x3 kernel for this.</span></span><br><span class="line">dilated_img = cv2.dilate(gray, kernel, iterations) <span class="comment"># gray is the grayscale image.</span></span><br><span class="line">eroded_img = cv2.erode(dilate_img, kernel, iterations)</span><br></pre></td></tr></table></figure>

<img src="/img/bigz-senior-project-week2.assets/image-20210423115652416.png" alt="Dilation and erosion" style="zoom:50%;" />

<p>Then, we can apply a threshold to the image with the following code to get a binary image from the de-noised image. You can see that one of the dirty points that did not get removed from previous processes was retained in the threshold processed image. </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cv2.threshold(erosion, threshold_value, <span class="number">255</span>, cv2.THRESH_BINARY)</span><br></pre></td></tr></table></figure>

<img src="/img/bigz-senior-project-week2.assets/image-20210423120048713.png" alt="threshold" style="zoom:50%;" />

<p>With the binary image we have, we can get the contour of the shapes with the code below and draw it out. As you can see, the contours are quite clear.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">contours, hierarchy = cv2.findContours(binary_image, cv2.RETR_TREE, cv2.CHAIN_APPROX_SIMPLE)</span><br></pre></td></tr></table></figure>

<img src="/img/bigz-senior-project-week2.assets/image-20210423141418895.png" alt="contours" style="zoom:50%;" />

<p>Lastly, we run a Hough Line Transform to detect the lines in the contours image, so we can find the corners and dimensions of the shapes. The code used here is </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lines = cv2.HoughLinesP(img, <span class="number">1</span>, np.pi/<span class="number">180</span>, <span class="number">100</span>,minLineLength=<span class="number">100</span>, maxLineGap=<span class="number">10</span>)</span><br></pre></td></tr></table></figure>

<img src="/img/bigz-senior-project-week2.assets/image-20210423142525498.png" alt="Hough Line Transform Result" style="zoom:50%;" />

<p>However, the results I get here is not very impressive, as it detects way more lines than it should, and there are small line segments clustered together if you zoom in the image. So, I will focus on fine-tuning the parameters for the Hough Line Transform next week. </p>

  </div>
</article>



        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/2018/12/02/%E5%85%B3%E4%BA%8E%E6%AD%A4%E5%8D%9A%E5%AE%A2/">About</a></li>
         
          <li><a href="/archives/">Writing</a></li>
         
          <li><a href="/basis-senior-project-home/">Senior Project</a></li>
         
          <li><a href="/search/">Search</a></li>
        
      </ul>
    </div>

    <div id="toc-footer" style="display: none">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#See-my-work"><span class="toc-number">1.</span> <span class="toc-text">See my work!</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#What-does-the-program-do"><span class="toc-number">2.</span> <span class="toc-text">What does the program do?</span></a></li></ol>
    </div>

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=https://www.jessexu.me/basis-senior-project/week2/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=https://www.jessexu.me/basis-senior-project/week2/&text=Week 2 - Image Preprocessing"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=https://www.jessexu.me/basis-senior-project/week2/&title=Week 2 - Image Preprocessing"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=https://www.jessexu.me/basis-senior-project/week2/&is_video=false&description=Week 2 - Image Preprocessing"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=Week 2 - Image Preprocessing&body=Check out this article: https://www.jessexu.me/basis-senior-project/week2/"><i class="fas fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=https://www.jessexu.me/basis-senior-project/week2/&title=Week 2 - Image Preprocessing"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=https://www.jessexu.me/basis-senior-project/week2/&title=Week 2 - Image Preprocessing"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=https://www.jessexu.me/basis-senior-project/week2/&title=Week 2 - Image Preprocessing"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=https://www.jessexu.me/basis-senior-project/week2/&title=Week 2 - Image Preprocessing"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=https://www.jessexu.me/basis-senior-project/week2/&name=Week 2 - Image Preprocessing&description="><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=https://www.jessexu.me/basis-senior-project/week2/&t=Week 2 - Image Preprocessing"><i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fas fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fas fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fas fa-share-alt fa-lg" aria-hidden="true"></i> Share</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
  <div class="footer-left">
    Copyright &copy;
    
    
    2018-2023
    Jesse Xu
  </div>
  <div class="footer-right">
    <nav>
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/2018/12/02/%E5%85%B3%E4%BA%8E%E6%AD%A4%E5%8D%9A%E5%AE%A2/">About</a></li>
         
          <li><a href="/archives/">Writing</a></li>
         
          <li><a href="/basis-senior-project-home/">Senior Project</a></li>
         
          <li><a href="/search/">Search</a></li>
        
      </ul>
    </nav>
  </div>
</footer>

    </div>
    <!-- styles -->



  <link rel="preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.2/css/all.min.css" crossorigin="anonymous" onload="this.onload=null;this.rel='stylesheet'"/>


    <!-- jquery -->
 
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" crossorigin="anonymous"></script> 




<!-- clipboard -->

  
    <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.7/clipboard.min.js" crossorigin="anonymous"></script> 
  
  <script type="text/javascript">
  $(function() {
    // copy-btn HTML
    var btn = "<span class=\"btn-copy tooltipped tooltipped-sw\" aria-label=\"Copy to clipboard!\">";
    btn += '<i class="far fa-clone"></i>';
    btn += '</span>'; 
    // mount it!
    $(".highlight table").before(btn);
    var clip = new ClipboardJS('.btn-copy', {
      text: function(trigger) {
        return Array.from(trigger.nextElementSibling.querySelectorAll('.code')).reduce((str,it)=>str+it.innerText+'\n','')
      }
    });
    clip.on('success', function(e) {
      e.trigger.setAttribute('aria-label', "Copied!");
      e.clearSelection();
    })
  })
  </script>


<script src="/js/main.js"></script>

<!-- search -->

<!-- Google Analytics -->

    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-132214073-1"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'UA-132214073-1');
    </script>

<!-- Baidu Analytics -->

<!-- Cloudflare Analytics -->

<!-- Umami Analytics -->

<!-- Disqus Comments -->


</body>
</html>
